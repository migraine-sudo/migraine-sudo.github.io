import{_ as e,o as s,c as a,ai as t,aH as n,aI as l,aJ as r,aK as h,aL as o,aM as p,aN as d,aO as k,aP as c,aQ as y,aR as g,aS as u,aT as m,aU as f,aV as E,aW as w,aX as b}from"./chunks/framework.ChYKzJpA.js";const P=JSON.parse('{"title":"Write for the Next Unlock: Notes on Security Research in the Pre-AI Era","description":"","frontmatter":{"title":"Write for the Next Unlock: Notes on Security Research in the Pre-AI Era","date":"2026/02/22","outline":"deep","translation":{"source":"/posts/unlock-note","status":"done"}},"headers":[],"relativePath":"en/posts/unlock-note.md","filePath":"en/posts/unlock-note.md"}'),v={name:"en/posts/unlock-note.md"};function D(F,i,B,A,C,I){return s(),a("div",null,[...i[0]||(i[0]=[t('<h1 id="write-for-the-next-unlock-notes-on-security-research-in-the-pre-ai-era" tabindex="-1">Write for the Next Unlock: Notes on Security Research in the Pre-AI Era <a class="header-anchor" href="#write-for-the-next-unlock-notes-on-security-research-in-the-pre-ai-era" aria-label="Permalink to “Write for the Next Unlock: Notes on Security Research in the Pre-AI Era”">​</a></h1><blockquote><p>When finding bugs stops being scarce, does research still matter?</p></blockquote><h2 id="prologue" tabindex="-1">Prologue <a class="header-anchor" href="#prologue" aria-label="Permalink to “Prologue”">​</a></h2><p>Summer 2025, in the talk hall in Athens, the moment I demoed unlocking a Tesla, my mind flashed back to a late afternoon in summer 2023.</p><p>Walking out of Beijing Global Trade Center after my KCon talk, the sunset was sliced into reflective shards on the glass curtain wall and fell across my phone.</p><p>I left myself a waypoint in Moments back then:</p><blockquote><p>&quot;When I first did binary security, I relied on known bug patterns to understand new code; but deep down I was uneasy—if no truly new offense/defense paradigms appear for long, could the colder, more niche radio frontier still let us create something original? On this path I often hit the question &#39;is this even a bug?&#39;, and many scenarios were imperfect, yet the feeling of creating from nothing kept pulling me forward.&quot;</p></blockquote><p>For years, digging deep in a vertical domain has been a source of identity for security folks, and learning new tech usually pays off. But this year everything feels different. As LLMs get stronger, machines can systematically mine &quot;known patterns&quot;; vuln hunting is becoming like an industrial QC line replacing manual sampling—faster, steadier, at scale. I sense the old narrative of &quot;proving value by finding bugs&quot; is on a countdown. When finding becomes non-scarce, pattern-based work will be eaten by automation; what&#39;s left will push researchers to deeper, cross-disciplinary frontiers. Where should we invest learning to chase real value? I didn’t have the answer; I only heard wind slipping through the Parthenon’s columns like an unfinished verdict.</p><p>After the event I walked into the night. The Acropolis glowed in the distance. The Parthenon was under repair, scaffolding and nets cutting its outline into fragments, yet it still stood firmly on the ridge, overlooking headlights and voices below.</p><figure><img src="'+n+'" alt="Athens, 2025/06/19" style="max-width:820px;width:85%;"><figcaption>Photo: Athens, Greece, 2025/06/19</figcaption></figure><h2 id="background-where-it-all-started" tabindex="-1">Background: Where It All Started <a class="header-anchor" href="#background-where-it-all-started" aria-label="Permalink to “Background: Where It All Started”">​</a></h2><p>I first cared about Tesla hacking in 2022 after seeing an <a href="https://www.youtube.com/watch?v=5mdU4ksOc2w" target="_blank" rel="noreferrer">NCC Group video</a> on YouTube. The core was still “relay” — hardly new: NFC relay for credit/metro cards, 433/315MHz RF key relays, BLE relays for EVs; these have been discussed for years. By all accounts it could be dismissed as &quot;old wine in a new bottle&quot;, yet my take was the opposite: NCC Group still broke new ground with the same relay idea, meaning the story wasn’t over.</p><figure><img src="'+l+'" alt="Relay attack diagram" style="max-width:720px;width:50%;"></figure><p>This diagram shows relay attacks for keyless entry: extend the key signal over a network so the car thinks the key is nearby.</p><p>What drew me in wasn’t just “unlocking a car” but the underlying question: can a niche like radio still yield truly original techniques? Tesla had patched keys multiple times, especially around latency; in the stacks I saw, business logic was more delay-sensitive, making pure app-layer relays less stable — pushing attention deeper into the link.</p><p>Colleagues and I followed the video’s breadcrumbs. Seeing NCC’s <a href="https://github.com/nccgroup/Sniffle" target="_blank" rel="noreferrer">Sniffle</a> for the first time was striking: not a spur-of-the-moment find but a toolchain iterated for six years. We replayed video details to identify their hardware; Dalin Yang spotted the TI CC2652RB dev kit, then traced the project. My manager @Bacde ordered it immediately; overseas shipping took weeks. For me, that moment was the starting gun: tools, hardware, and entry docs were clear, giving me confidence to own this OKR. It was the beginning of everything that followed.</p><figure><img src="'+r+'" alt="bletool" style="max-width:820px;width:80%;"></figure><p>Picture: the toolchain NCC Group used</p><h2 id="starting-from-zero" tabindex="-1">Starting From Zero <a class="header-anchor" href="#starting-from-zero" aria-label="Permalink to “Starting From Zero”">​</a></h2><p>BLE link-layer relay is a hard target. Unlike Wi‑Fi’s fixed channel, BLE has 37 data channels and hops every millisecond per algorithm (#1/#2), making sniffing hard. Over the years BLE added SMP for pairing/key exchange, encrypting payloads. The bar is high for anyone studying BLE internals.</p><figure><img src="'+h+'" alt="blerelay_hop" style="max-width:820px;width:65%;"></figure><p>Figure: BLE keeps hopping channels</p><p>Switching from binary to radio, I soon realized I carried one intuition into a different world. In binary I had a toolkit and method: disassembly, debugger, memory layout, call stacks—things you can “see.” In BLE, the first blocker wasn’t protocol complexity but tooling: what’s the exact over-the-air timing, how acks/retries behave, how connects/disconnects manifest—I couldn’t observe them.</p><p>Most dev boards (nRF52, TI CC series) expose L2CAP or higher: you call GATT, read/write characteristics—great DX, but lower layers are hidden, often in vendor stacks. Years later third-party security projects (e.g., <a href="https://asset-group.github.io/disclosures/sweyntooth/" target="_blank" rel="noreferrer">SweynTooth</a>) exposed more. So when I first asked &quot;does link-layer relay matter?&quot; I lacked intuition: link layer isn’t as visual as app layer; it’s a precise system where imagination easily misleads.</p><div class="img-row"><figure><img src="'+o+'" alt="blestack" style="max-width:720px;width:60%;"></figure><figure><img src="'+p+`" alt="connectind" style="max-width:820px;width:100%;"></figure></div><p>Figure: BLE stack and CONNECT_IND PDU</p><p><strong>&quot;The 2021 hospital stay&quot;</strong></p><p>I hadn’t gone in blind. During a two-week hospital stay in 2021, I read the BLE parts of Bluetooth 5.3 core spec end-to-end: layers, PDUs, fields. But when the question became “why must we relay link layer” or “where is latency checked,” that understanding felt thin.</p><p>Worse, radio security is niche and docs are scarce; I’m not a comms major and had no RF base: modulation/demodulation, sampling rate—recognizable words, not real understanding. Some facts felt counterintuitive: how can a Raspberry Pi pin radiate? What do physical/link layers mean in engineering terms? Big target, few tools; that period was frustrating.</p><p>I made a &quot;dumb&quot; decision: build it myself. Using HackRF, I tried to implement a minimal BLE RX chain, forcing myself to turn “spec flow” into “something that runs.”</p><p>That became <a href="https://github.com/migraine-sudo/BTLE-R" target="_blank" rel="noreferrer">BTLE-R</a>. It’s incomplete: only advertising RX; TX is poor in Python—firmware would be better. But it was enough: once I personally strung modulation, demodulation, hopping together, the stack stopped being a diagram and became a tangible process. With that intuition, I had the confidence to continue. The path is niche and hard, but not impossible.</p><h2 id="key-technique-part-1-early-missteps-why-plan-1-fails" tabindex="-1">Key Technique (Part 1): Early Missteps &amp; Why Plan 1 Fails <a class="header-anchor" href="#key-technique-part-1-early-missteps-why-plan-1-fails" aria-label="Permalink to “Key Technique (Part 1): Early Missteps &amp; Why Plan 1 Fails”">​</a></h2><div class="tip custom-block"><p class="custom-block-title">Skip</p><p>Heavy technical detail; skip to “Good News Before National Day / External Events / Afterword” for quick read.</p></div><details open><summary>Technical detail</summary><p>At first I led us astray. In hindsight the misunderstanding was “natural”: I applied radio relay and network forwarding intuition directly to BLE. In many legacy radio scenes, relay is simple: listen on a fixed channel, forward, get response. You care about link-up, bandwidth, noise, distance; if you can hear and forward, systems keep running.</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">channel </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">433Mhz</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">C               P_r             C_r             P</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PDU(Adv seed)</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                PDU(Adv seed)</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">-----&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                PDU(Resp)</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PDU(Resp)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PDU(Resp)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PDU(Resp)</span></span></code></pre></div><p>I even discussed a seemingly reasonable plan: BLE hops, so compute hop pattern, follow it, and relay in real time. Channel map/hop aren’t unknowable; blejack proved they’re trackable. Thus “Plan 1”: place two relay devices near victim central/peripheral; capture LL data on one side, forward via Wi‑Fi/Ethernet, transmit on the matched channel on the other. To make it work I did two key pieces:</p><ul><li>Parse hopping params to derive channel map and hop sequence.</li><li>Switch channels per sequence: “you speak on ch 8, I relay on ch 8; you jump to 25, I follow.”</li></ul><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">victim central (C)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">victim peripheral (P)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">relay master (C_r)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">relay slave (P_r)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">channel x (hopping, unchanged within one connection event)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">channel </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">C               P_r             C_r             P</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PDU(Encrypted)</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                LL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PDU(Encrypted)</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">-----&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                LL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PDU(Encrypted)</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PDU(EncResp)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PDU(EncResp)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PDU(EncResp)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">channel </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">C               P_r             C_r             P</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PDU(Encrypted)</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                LL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PDU(Encrypted)</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">-----&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                LL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PDU(Encrypted)</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PDU(EncResp)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PDU(EncResp)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PDU(EncResp)</span></span></code></pre></div><p>On paper, not absurd. BLE hopping isn’t magic; projects like blejack proved it.</p><p>What I underestimated was BLE’s other side: a highly parameterized, timing-sensitive connection. WinOffset/WinSize set the first window; connInterval sets the beat (min 7.5ms); peripheralLatency lets you skip some events but not relax cadence; supervisionTimeout watches if the link is “alive on time”; ChM/Hop/ChSel control hopping. Together they mean: LL connections are extremely delay-sensitive.</p><figure><img src="`+d+'" alt="blerelayproblem" style="max-width:820px;width:85%;"></figure><p>Within one connInterval, RX/TX have strict windows and gaps (e.g., T_IFS). Many stacks drop links quickly after a few failed retries. Forwarding LL PDUs over Wi‑Fi/Ethernet adds single-side delays of ms–tens of ms; normal for IP, but it wrecks BLE’s metronome. Miss the anchor, and subsequent events misalign; hit supervision timeout/retry failure, and the link drops.</p><p>Normal BLE timing diagram:</p><img src="'+k+'" alt="ctop" style="max-width:280px;width:150%;"><p>A concrete picture: normally C&lt;-&gt;P RTT is tiny; close devices finish within one event window. In Plan 1, C’s data goes to P_r, then over Wi‑Fi to C_r, then to real P. Wi‑Fi alone can add ~50ms, while a connection event’s data window is bounded by connInterval/transmit window, derived from connect_ind—you can’t change it.</p><p>The classic “off-beat” appears: when C-&gt;P_r happens, the link is on channel 8; by the time data loops to C_r-&gt;P, that window is gone, the link may have hopped or even dropped via supervisionTimeout/failed retries.</p><p>Plan 1 failure diagram:</p><img src="'+c+'" alt="failreson" style="max-width:280px;width:150%;"><p>Only then did I grasp: LL relay is hard not because of “how many channels,” but because of “timing and heartbeat.” This failure rewrote the question from “how to pass packets” to “can we change the model so cross-network delay doesn’t break the LL beat?” I tried many times, but at least I could now explain the failure and discard a plausible yet wrong model. Falsification has value.</p></details><h2 id="key-technique-part-2-the-right-model-emerges" tabindex="-1">Key Technique (Part 2): The Right Model Emerges <a class="header-anchor" href="#key-technique-part-2-the-right-model-emerges" aria-label="Permalink to “Key Technique (Part 2): The Right Model Emerges”">​</a></h2><div class="tip custom-block"><p class="custom-block-title">Skip</p><p>Heavy technical detail; skip to “Good News Before National Day / External Events / Afterword” for quick read.</p></div><details open><summary>Technical detail</summary><p>Once I understood the failure, the final approach became natural and a bit counterintuitive: don’t keep one link in sync across networks. Instead, build two independent BLE links at each end; use local timing to keep them alive; only shuttle LL payloads across the network.</p><p>Concretely: near the victim phone/key (central), a dev board pretends to be a fake peripheral, establishing a full BLE link with the phone. Near the car (peripheral), another board pretends to be a fake central, establishing another independent link with the car. Each link has its own Access Address/CRC and doesn’t need cross-sync. Phone and car each see a “normal peer.”</p><p>We then forward only LL PDUs, not physical-layer preamble/AA/CRC tied to a specific link. To keep both links from timing out, we fill idle slots with Empty PDUs, maintaining local event cadence so T_IFS/connInterval/supervisionTimeout aren’t violated. When real data arrives, we swap an Empty PDU for the real LL payload.</p><p>In short: two independent links + Empty PDU keepalive + forward only LL PDUs.</p><figure><img src="'+y+`" alt="blerelay2" style="max-width:820px;width:100%;"></figure><p>This matches what NCC later published in 2025; we arrived there independently.</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">First, the relay master (C_r) gathers the adverisement body </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scan response</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> the victim peripheral (P). Next, the advertisement data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> passed onto</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">the relay slave (P_r) to mimic the victim peripheral. Once the victim</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">central (C) connects to the relay slave (P_r) mimicking the victim peripheral,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">the relay slave will inform the relay master, so that it can start its own</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">connection to the real victim peripheral </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> potentially different parameters.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">C               P_r             C_r             P</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">----------</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Advert</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                ScanReq</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">---------&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ScanRsp</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Advert</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ScanRsp</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Advert</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ScanReq</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ScanRsp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ConnReq</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(I starts channel hopping </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> P_r)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                ConnReq</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                (wait </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> next</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> advert)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">----------</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Advert</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                ConnReq</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">---------&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Once connected, data can be encrypted, but we don</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;t care, we just pass it on.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">One limitation </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> that encrypted </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LL_CONTROL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> messages could change hopping</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parameters, but we can</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;t decipher them. It may be possible to make an educated</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">guess of what the control messages are though based on past behaviour.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">C               P_r             C_r             P</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Encrypted</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">----------</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Empty</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                Encrypted</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">-----&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                Encrypted</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EncResp</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                &lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--------</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EncResp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(wait </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> next</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> conn event)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Empty</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">---------&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">------</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EncResp</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span></span></code></pre></div><p>Key points:</p><ul><li>Each side maintains an independent LL connection, hopping per its own Channel Map/Hop/ChSel. No four-way sync, no aligning hop sequences between links.</li><li>The cross-network path only carries LL payloads, not real-time LL handshakes. Empty PDUs locally maintain connInterval/T_IFS/supervisionTimeout, so TCP/IP RTT need not fit the peer’s LL window. Cross-network latency only shifts which connection event the payload lands in; it doesn’t trigger LL timeouts.</li><li>For most payloads, SMP encryption doesn’t block “ciphertext passthrough”: encrypted data stays encrypted in LL payload; the relay just forwards without decryption or app-layer understanding.</li></ul><figure><img src="`+g+'" alt="llrelay" style="max-width:820px;width:85%;"></figure><p>Compared to GATT-layer relays, LL relay’s advantage is decoupling cross-network latency from LL timing: two local links with Empty PDUs keep the beat, so simple latency checks won’t break it. And because we relay LL PDUs, SMP-encrypted ciphertext passes through without needing to decrypt/interpret app semantics.</p><img src="'+u+'" alt="llenc" style="max-width:820px;width:85%;"><p>Once the model was clear, the hard part became engineering details. “Use Empty PDU to keepalive” is one-liner theory; in practice it’s pitfalls: how to send empties without errors; which packets must relay, which must drop; how to detect/recover if dropped wrongly; why links randomly wobble. I first tested with a band and a phone, running back and forth, staring at whether adverts were missed or connections dropped—inefficient and draining. Later I realized many validations don’t need devices far apart: keep them nearby, watch logs and timing, and you can tell if the model works. Test cycles shrank into control.</p><p>Engineering is still hard. That’s why I admire NCC’s persistence: you’re not solving one problem, you’re facing an unseen finish line where every idea spawns new issues.</p></details><h2 id="good-news-before-national-day" tabindex="-1">Good News Before National Day <a class="header-anchor" href="#good-news-before-national-day" aria-label="Permalink to “Good News Before National Day”">​</a></h2><p>“2022 pre-National Day”</p><p>The final push came when my boss visited Beijing. We knocked down remaining engineering issues: Empty PDUs kept links stable; we filtered non-relay packets; the link could now sustain encrypted relay for “long enough.” It would never be as solid as direct links—occasional flakiness and drops—but BLE auth to unlock and start a car is only a few minutes.</p><p>After multiple rejections, a colleague finally lent me a Tesla for an afternoon. The first attempt failed. We traced the link end-to-end: the garage was too dark and I mistyped the MAC. Fixed it; colleague stayed outside Xiaomi campus, I inside reran the flow—this time the door unlocked and the car started. I didn’t cheer; I first checked logs and link state to ensure it was due to the relay, not chance. Once sure, I accepted: the attack worked.</p><p>We wrapped it before 2022 National Day. I took a train home; body exhausted, mind electric—“maybe this is the best day of my life.” Back then I’d have talked your ear off: leaving a mark on hacker history, impacting future products or real-world safety. Today, looking back, the answer is simpler: the fun of the challenge and the satisfaction of making it work.</p><h2 id="the-crushing-external-event" tabindex="-1">The Crushing External Event <a class="header-anchor" href="#the-crushing-external-event" aria-label="Permalink to “The Crushing External Event”">​</a></h2><p>Not long after success, we saw a hardwear.io talk: NCC Group publicly presented BLE link-layer relay.</p><p>It hit hard. Before we could publish, NCC had shared the key points and some details. To me it felt like my months of groundwork were laid bare: hard-earned conclusions appeared in a more authoritative, complete form. Shock gave way to a hollow feeling: did my effort just get prewritten elsewhere?</p><p>“2026 hindsight”</p><p>In 2026 a similar emotion repeats in another form. AI base models are stronger; skills that once needed long training can now be done “decently” by a novice with an agent + MCP + a few prompts. Does that devalue our past research, even make it meaningless? It echoes that time: you solved it, but someone else published first. Was it wasted?</p><p>No single answer.</p><p>I won’t prescribe “the path.” My view now: we’re too used to treating ourselves as output machines; but people aren’t tools, and value is hard to define by “results” alone—results get superseded and time erases them. What’s truly yours are the understanding, experience, and judgment grown in exploration.</p><p>AI may quickly learn what took you years, but it can’t replace the moments only your body and presence can bear: the slight tremor unlocking a car, the panic of a drowning phone in Phuket, sprinting back from Burj Khalifa in a 4‑hour Dubai layover, or reflexively shooting a rainbow after rain. Those feelings are yours alone.</p><p>Security research is similar. For me, the most valuable part is often the process: simplifying problems, correcting mistakes, the joy of solving. The “candy” — unlocking, driving away — matters but isn’t the whole meaning.</p><p>Practically: NCC shared ideas and partial implementation, but no drop-in exploit. For those unfamiliar with BLE, even with reduced difficulty, you still need to understand protocol, timing, and engineering to run it. Many peers later asked me LL questions; some came to KCon for my talk; some reproduced success with my hints. That joy is concrete: not “first publish” thrill, but that what you know tangibly helps others—more lasting fulfillment.</p><h2 id="talks-and-journeys" tabindex="-1">Talks and Journeys <a class="header-anchor" href="#talks-and-journeys" aria-label="Permalink to “Talks and Journeys”">​</a></h2><p>“KCon 2023” I still submitted the talk. Without public scripts and with growing inquiries, better to explain end-to-end once to clear misconceptions. After KCon, I went to HITBSecConf in Phuket. What stuck wasn’t the island but a small mishap: my phone fell into seawater. No backup, facing days offline panic. Just before teardown, it revived—probably from long blow-drying in the hotel. Like research: you think you’re “researching,” but what keeps you going are the mundane, on-the-spot fixes that set things back on track.</p><p>“OffensiveX Athens 2025” Three years later, OffensiveX in Athens. Though the talk was on another car topic, the organizers wanted a live hack on a European Tesla—a formal closure for the BLE relay I’d never demoed live.</p><p>But accidents happen at the worst time: the dev board’s micro USB snapped during the long flight. My fault—left the cable plugged; 20+ hours of pressure broke the solder. Worse, we were jetlagged, fixing slides for the demo. After rehearsal it was evening; we had to reach the Lake Vouliagmeni dinner for speakers/sponsors and also fix the board. We tried everything, scooting around Athens on e-scooters, finally finding a phone-repair shop. An Indian owner re-soldered it after some bargaining. We barely made the dinner, only to learn it was delayed—“almost missed it” tension returned.</p><img src="'+m+'" alt="offensivex1" style="max-width:280px;width:100%;"><p>Demo day: laptop in hand, Tesla curbside, camera crew ready, passersby stopping to watch. The actual hacking minutes were quiet: check device state, read logs, run flow—mind calm. When the door unlocked again, applause came from inside and outside; déjà vu. Not pure “result” excitement, but a confirmation: I’d kept pushing farther and almost forgot why I loved this; that moment pulled me back—I was still on the same track, just farther along.</p><p>Afterward I got feedback from many fields: peers, educators, students, non-security folks—they liked the show, wanted photos. Those looks and handshakes reminded me this wasn’t just for a niche—it could be heard and understood.</p><p>That’s why a small thing stuck: a DM from poc_crew. They’d seen the Tesla demo and asked if I’d research Korean cars and speak. I didn’t have a new story ready; I thanked them but said a new talk needs time. That message wasn’t an answer, but an echo—years-old work hadn’t vanished; it might return unexpectedly and nudge you toward the next unknown.</p><div class="img-row"><figure><img src="'+f+'" alt="poc1" style="max-width:280px;width:100%;"></figure><figure><img src="'+E+'" alt="poc2" style="max-width:280px;width:100%;"></figure></div><p>Later I cut the trip into a short Europe video. Color and story need work, but I liked the ending: I shot the cameraman, he shot me. The recorder being recorded felt like the cleanest footnote.</p><div class="img-row"><figure><img src="'+w+'" alt="photographer" style="max-width:280px;width:80%;"></figure><figure><img src="'+b+'" alt="hackingtesla" style="max-width:420px;width:110%;"></figure></div><h2 id="afterword-where-to-next" tabindex="-1">Afterword: Where To Next? <a class="header-anchor" href="#afterword-where-to-next" aria-label="Permalink to “Afterword: Where To Next?”">​</a></h2><p>“End of 2025”</p><p>By end of 2025, NCC finally open-sourced their relay scripts. Seeing the repo, I felt calm: from “rumor” to “paper/talk” to “reproducible code,” the lifecycle was complete. For me it was a period. Beyond that, a louder backdrop emerged: times changed.</p><p>Even the best research faces reality: AI is industrializing known paradigms, compressing skills into a few prompts. Anxiety follows: when “finding bugs” isn’t scarce, are our honed skills/methods still worth it?</p><p>I’m more convinced the answer is yes. The meaning shifted: tools will run much of the repetitive path, but won’t decide where to blaze new trails.</p><p>Continuing research in the AI era reminds me of Odysseus sailing past the Sirens. The sirens lure sailors with song; hear them and you steer onto rocks. Odysseus had sailors plug their ears with wax and tied himself to the mast, ordering them not to untie him no matter what. “Hear yet not veer” costs extra.</p><p>Research value often hides in that cost—especially in real, complex systems: identity and trust chains, supply/update chains, protocols and device ecosystems. AI’s misjudgments and blind spots remain; humans must set boundaries, validate models, and own conclusions.</p><p>That night in Athens, the Acropolis lights stayed on. The Parthenon, under repair, its outline cut by scaffolding, still stood firm—a 21st-century machine working atop it.</p><p>(to be continued)</p>',72)])])}const L=e(v,[["render",D]]);export{P as __pageData,L as default};
